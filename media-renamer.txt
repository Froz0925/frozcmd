Froz media renamer (media-renamer.cmd)
--------------------------------------

Пакетное переименование файлов по маске: YYYY-MM-DD_HHMMSS_имя_[PROGR].ext
для упорядочивания фото-видеоархивов с файлами из разных источников и форматов имён.

Режимы работы:
   - Если первый аргумент - папка: обрабатываются все файлы в ней, кроме подпапок. Остальные аргументы игнорируются.
   - Если первый аргумент - файл: обрабатываются все переданные файлы, папки игнорируются. Все файлы должны быть в одной папке.

Порядок извлечения даты:
   - Для JPG: сначала читается EXIF.DateTimeOriginal (DTO).
     * Если DTO есть и совпадает с именем - файл пропускается.
     * Если DTO есть, но не совпадает - переименовывается по EXIF.
     * Если DTO нет - предлагается диалог:
         - автоматически записать EXIF в остальные JPG без DTO (с датой каждого файла)
         - записать EXIF только в этот файл
         - ввести вручную
       Предлагаемая дата формируется по приоритету: дата из имени, время из DLM (гибрид), или вся дата из DLM.
   - Для остальных файлов: аналогично, но без EXIF. Сначала ищется дата+время в имени, затем - из даты изменения (DLM).
     Если маска не совпадает - файл переименовывается.
 
Другие особенности:
   - Приоритет источников даты: DTO (EXIF) > дата в имени > DLM (дата изменения)
   - Извлечённые даты-время проверяются на корректность (год 1900-2100, часы 00-23, минуты 00-59 и т.п.).
   - При общей длине имён в аргументах более 7000 символов - выдаётся предупреждение, что часть файлов будет пропущена (лимит Windows - 8100 символов).
   - Удаляются префиксы: IMG_, VID_, DSC_, PIC_.
   - Progressive JPEG (SOF2 в структуре заголовка) помечаются суффиксом _PROGR.
     Зачем: такие файлы в высоком разрешении медленно открываются во вьюверах. Метка помогает позже пакетно пересохранить их в базовый режим.
   - При конфликте имён (уже есть файл с таким именем) - добавляется _1, _2 и т.д.
   - Поддерживаются сложные форматы входных имён: YYYYMMDD_HHMMSS, YYYY-MM-DD_HHMMSS, YYYY-MM-DDhhmmss, и др., включая пробелы и разделители.

Примеры обработки:
IMG_0110-prgr.JPG          -> 2025-07-06_120008_0110-prgr_PROGR.JPG
IMG_0110_noDTO.JPG         -> 2025-07-06_120008_0110_noDTO.JPG
IMG_20220804 174724445.jpg -> 2022-08-04_174724_445.jpg
2022-08-041747245.jpg      -> 2022-08-04_174724_5.jpg
2022-08-047747245.jpg      -> 2022-08-04_201527_7747245.jpg
20220704_174724_HDR.jpg    -> 2022-07-04_174724_HDR.jpg
2021-07-04_574724.mkv      -> 2021-07-04_201458_574724.mkv
2021-07-05_160242221.mov   -> 2021-07-05_160242_221.mov
2010-12-26_P1040166 ДР.jpg -> 2010-12-26_201447_P1040166 ДР.jpg
2021-07-04_174724.mp4      -> 2021-07-04_174724.mp4



Краткое описание:

froz_media_renamer.cmd - переименовывает фото/видео по маске: ГГГГ-ММ-ДД_ЧЧММСС_имя.
Для извлечения дат будущего имени работает с EXIF-JPG (DTO), датой в имени в различных сочетаниях символов и датой изменения файла (DLM).
Помечает Progressive JPEG как _PROGR для дальнейшего пакетного пересохранения.
Приоритет: EXIF > имя файла > DLM.
Не переименовывает уже правильные имена, обрабатывает конфликты имён.
